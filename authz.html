

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Authorization &mdash; Vespene  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CLI" href="cli.html" />
    <link rel="prev" title="Webhooks" href="webhooks.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="contents.html" class="icon icon-home"> Vespene
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">About Vespene</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Fundmentals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workers.html">Workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="variables.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="access.html">Access</a></li>
</ul>
<p class="caption"><span class="caption-text">Workflow</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="importing.html">Imports (.vespene)</a></li>
<li class="toctree-l1"><a class="reference internal" href="launch_questions.html">Launch Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduling.html">Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="webhooks.html">Webhooks</a></li>
</ul>
<p class="caption"><span class="caption-text">Admin</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Authorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ownership">Ownership</a></li>
<li class="toctree-l2"><a class="reference internal" href="#groups-required">Groups Required</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-customizations">Further Customizations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrades.html">Upgrades</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_setup.html">Development Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_guide.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ / Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="partnership.html">Partnership Program</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">Vespene</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html">Docs</a> &raquo;</li>
        
      <li>Authorization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/authz.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <img alt="Vespene Logo" class="align-right" src="_images/vespene_logo.png" />
<div class="section" id="authorization">
<span id="authz"></span><h1>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h1>
<p>Vespene provides ways to several ways to control who can use it and how, to prevent unwanted access changes.</p>
<p>This authorization system is pluggable, and two plugins, called “ownership” and “groups_required” are installed by default.</p>
<p>The ownership plugin has no configuration parameters and includes a default policy, and the “groups_required” plugin is configurable
and can optionally further lock down those rules.</p>
<p>Authentication (checking usernames and passwords) must of course happen first. Nothing much in Vespene is really allowed to happen anonymously (without login), except
access to build results when fileserving is turned on (because logging in might be annoying). Fileserving can be turned off
as per <a class="reference internal" href="settings.html#settings"><span class="std std-ref">Settings</span></a>.  Authentication uses standard Django methods.</p>
<div class="section" id="ownership">
<h2>Ownership<a class="headerlink" href="#ownership" title="Permalink to this headline">¶</a></h2>
<img alt="Example Ownership Tab on Project Dialog" class="align-right" src="_images/authz1.png" />
<p>The ownership plugin provides common sense access control. Rather than have a very complex policy system where it is easy to make
an error, the ownership plugin encapsulates the kinds of behaviors most users would expect to be able to control, while also making it easy to lock
down the build system rather than leaving it wide open to (potential) chaos and accidental misconfiguration.</p>
<p>With the ownership plugin installed, the following behavior occurs:</p>
<ol class="arabic simple">
<li>Superusers can do everything</li>
<li>Users who create an object can always edit or delete that object.</li>
<li>Users can edit the ‘ownership groups’ of an object to extend edit/delete rights to other groups of users.</li>
<li>Users who can edit a project can automatically run the project (aka “build the project”).</li>
</ol>
<p>There are a few exceptions. Only superusers are allowed to create and edit worker pools, because the security configurations of those are of great importance.
Also, no users can create or delete Build history objects via the interface.  There is a CLI command to remove old build records and directories that
admins can run, perhaps on cron, to clean up old records.</p>
<p>With the ownership plugin, it is not required to be able to edit a project to run a project. Additionally, on a project, “launch groups” can be specified in the onwership tab, granting access to start a project build or job
execution without having the ability to edit that particular project.  This works particularly well with <a class="reference internal" href="launch_questions.html#launch-questions"><span class="std std-ref">Launch Questions</span></a> to
implement a self-service console for executing tasks.</p>
<p>You can tell if the plugin is enabled by looking at your settings file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">authorization</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
      <span class="n">ownership</span> <span class="o">=</span> <span class="s2">&quot;vespene.plugins.authorization.ownership&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Normally the plugin only limits access but does not hide objects the user does not have access to.  This can result in seeing a LOT
of projects, and some organizations may wish for a team to only see the projects they may have ownership or launch permissions for.
To enable greater filtering, the plugin configuration can be adjusted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">authorization</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
      <span class="n">ownership</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;vespene.plugins.authorization.ownership&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filter_view</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The filter_view parameter is designed to make lists more compact (for example, in environments with hundreds of projects), but is not designed
to keep project configurations or user/team existance secret.  Transparency in an organization is a good thing anyway.</p>
<p>We expect the vast majority of all Vespene users will want to leave the ownership plugin engaged.</p>
</div>
<div class="section" id="groups-required">
<h2>Groups Required<a class="headerlink" href="#groups-required" title="Permalink to this headline">¶</a></h2>
<p>The ownership plugin provides some common sense access control, mostly at a per-object level.  Sometimes in an organization further
access restrictions on a larger scale are desirable.</p>
<p>The initial configuration of the groups required plugin does not impose any additional restrictions, however, it can be configured
in the settings file to limit access to certain actions on certain object types to particular groups of users.</p>
<p>As mentioned, the default configuration does nothing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PLUGIN_CONFIGURATION</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">authorization</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
           <span class="n">ownership</span> <span class="o">=</span> <span class="s2">&quot;vespene.plugins.authorization.ownership&quot;</span><span class="p">,</span>
           <span class="n">group_required</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;vespene.plugins.authorization.group_required&quot;</span><span class="p">,</span> <span class="p">{}</span> <span class="p">]</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Here is an example that limits the ability to create projects to a limited list of groups:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PLUGIN_CONFIGURATION</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">authorization</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
       <span class="n">ownership</span> <span class="o">=</span> <span class="s2">&quot;vespene.plugins.authorization.ownership&quot;</span><span class="p">,</span>
       <span class="n">group_required</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;vespene.plugins.authorization.group_required&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span>
             <span class="n">project</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                 <span class="n">create</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;qa&#39;</span><span class="p">,</span> <span class="s1">&#39;ops&#39;</span><span class="p">],</span>
             <span class="p">)</span>
         <span class="p">)</span>
     <span class="p">]</span>
 <span class="p">),</span>
</pre></div>
</div>
<p>This example gives requires users to have a login, but further requires that only Developers, QA, and Ops teams can create projects.
We do not bother restricting other types of actions here, because the ownership system will provide those levels of restrictions automatically.</p>
<p>The following types of object may be specified with this plugin:</p>
<ul class="simple">
<li>project</li>
<li>build</li>
<li>user</li>
<li>group</li>
<li>snippet</li>
<li>variableset</li>
<li>sshkey</li>
<li>servicelogin</li>
<li>workerpool</li>
</ul>
<p>The following verbs may be specified:</p>
<ul class="simple">
<li>create</li>
<li>list</li>
<li>edit</li>
<li>delete</li>
<li>view</li>
<li>stop</li>
<li>start</li>
</ul>
<p>If a noun or verb is not mentioned, the noun/verb combination is not restricted by this plugin.  So, by default, this plugin
imposes no restrictions.</p>
<p>If the value of a restriction list is “[]” (empty list), it means the action is completely forbidden by all types of users except
superusers. It would, however, be better to specify a group name, like “vespene_admins” instead.</p>
<p>Usage of this plugin without the ownership plugin doesn’t make a lot of sense and will not result in a very secure configuration.</p>
<p>Also, it’s easy to configure this in ways that don’t match real world use cases. For instance, access can be removed to edit
a project, while leaving access to create projects, which doesn’t make a lot of sense.</p>
<p>As previously mentioned, this imposes additional restricts beyond ownership, so being able to create or edit here does not
imply creating and editing to all types of objects, unless the user is a superuser - ownership would still be required.</p>
</div>
<div class="section" id="further-customizations">
<h2>Further Customizations<a class="headerlink" href="#further-customizations" title="Permalink to this headline">¶</a></h2>
<p>Users can add more plugins if they want to.</p>
<p>Additional plugins subtractively stack restrictions with any loaded plugins, so if any plugin says “no” to something
that object is not included.</p>
<p>Plugins can both prohibit action or filter objects from view.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cli.html" class="btn btn-neutral float-right" title="CLI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="webhooks.html" class="btn btn-neutral" title="Webhooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael DeHaan LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
  <style>
    .wy-side-nav-search, .wy-nav-top {
      background: #444444;
    }
    .wy-nav-side {
      background: #444444;
    }
  </style>


</body>
</html>